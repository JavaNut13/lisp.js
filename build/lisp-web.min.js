/*! @javanut13/lisp.js 2016-04-03 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports={map:"function map(f, l){var r=[];for(var i=0;i<l.length;i++)r.push(f(l[i]));return r;}",filter:"function filter(f, l){var r=[];for(var i=0;i<l.length;i++)f(l[i])&&r.push(l[i]);return r;}",reduce:"function reduce(f, v, l){for(var i=0;i<l.length;i++)v=f(v,l[i]);return v;}",type:"function type(a) {return typeof a;}",range:"function range(a) {var r=[];for(var i=0;i<a;i++)r[i]=i;return r;}",apply:"function apply(f, a) {return f.apply(null, a);}"}},{}],2:[function(a,b,c){function d(){this.default_methods={}}function e(a,b){var c=a.getAll(b),d=c[c.length-1];return c[c.length-1]="return "+d,c.join(";\n")}function f(a,b){if("iden"===b.cont[0].type&&"else"===b.cont[0].cont)return e(a,b.cont.slice(1));for(var c=b.cont[0].cont.cont,d="",f="var ",g=!0,h=!0,i=0;i<c.length;i++)"iden"!==c[i].type?(g||(d+="&&"),g=!1,d+="arguments["+i+"]==="+a.get(c[i])):(h||(f+=","),h=!1,f+=c[i].cont+"=arguments["+i+"]");g||(d+="&&"),d+="arguments.length==="+c.length,h&&(f="");var j=e(a,b.cont.slice(1));return"if("+d+") {\n"+f+";\n"+j+";\n}"}function g(a,b,c){var d=c?-1:0,g=c?"":a.get(b[0]);if("quote"==b[d+1].type){var h=a.getAll(b[d+1].cont.cont),i=e(a,b.slice(d+2)),j="function "+g+"("+h.join(", ")+") {\n";return j+=i,j+=";\n}"}for(var k=b.slice(d+1),j="function "+g+"() {\n",l=0;l<k.length;l++)j+=f(a,k[l])+"\n";return j+';throw "Unexhaustive matching";\n}'}var h=a("./defaults"),i=d.prototype;i.get=function(a){return this[a.type](a)},i.getAll=function(a,b){b=b||0;for(var c=[];b<a.length;b++)c.push(this.get(a[b]));return c},i.infix_operators={"+":!0,"-":!0,"/":!0,"*":!0,"%":!0,"&&":!0,"||":!0,"<":!0,">":!0,"<=":!0,">=":!0,"=":"==="},i.infix=function(a){var b=this.get(a.cont[0]);this.infix_operators[b]!==!0&&(b=this.infix_operators[b]);var c=this.getAll(a.cont.slice(1));return"("+c.join(b)+")"},i.builtins_fn=function(a){return g(this,a,!0)},i.builtins_defn=function(a){return g(this,a)},i.builtins_def=function(a){return"var "+this.get(a[0])+"="+this.get(a[1])},i.builtins_if=function(a){var b=this.get(a[0]),c=this.get(a[1]),d=a[2]?this.get(a[2]):"undefined";return"("+b+"?"+c+":"+d+")"},i.builtins_first=function(a){var b=this.get(a[0]);return b+"[0]"},i.builtins_rest=function(a){var b=this.get(a[0]);return b+".slice(1)"},i.builtins_try=function(a){var b=this.get(a[0]),c=a[1]?this.get(a[1]):"null";return"try {\n"+b+"\n} catch(error) {\n"+c+";\n}"},i.string=function(a){return'"'+a.cont+'"'},i.number=function(a){return a.cont},i.iden=function(a){return a.cont},i.quote=function(a){var b=a.cont;if("list"===b.type){for(var c=[],d=b.cont,e=0;e<d.length;e++){var f=d[e];c.push(this.get(f))}return"["+c.join(", ")+"]"}return this.get(f)},i.list=function(a){var b=this.get(a.cont[0]);if(b.endsWith("}")&&(b="("+b+")"),this["builtins_"+b])return this["builtins_"+b](a.cont.slice(1));if(this.infix_operators[b])return this.infix(a);if(h[b]&&(this.default_methods[b]=!0),b.startsWith("."))var c=this.get(a.cont[1])+b+"(",d=2;else{if(b.startsWith(":"))return this.get(a.cont[1])+"."+b.slice(1);var c=b+"(",d=1}return c+=this.getAll(a.cont,d).join(", "),c+=")"},b.exports.generate=function(a){for(var b=new d,c=[],e=0;e<a.length;e++){var f=a[e],g=b[f.type];if(!g)throw"Unexpected symbol "+JSON.stringify(f.cont);c.push(b[f.type](f)+";\n")}var i="";for(method in b.default_methods)i+=h[method]+";\n";for(var e=0;e<c.length;e++)i+=c[e];return i}},{"./defaults":1}],3:[function(a,b,c){var d=a("./parse"),e=a("./generate"),f=function(a){var b=d.parse(a);return e.generate(b)};b.exports.toJS=f},{"./generate":2,"./parse":4}],4:[function(a,b,c){function d(a){for(type in g){var b=g[type].re.exec(a);if(b){var c=b[0],d=b[1]||c;return{type:type,cont:!g[type].ignore&&d,length:c.length}}}}function e(a){var b=d(a);if(!b)return null;var c=b.length;if(delete b.length,"list-start"===b.type)return f(a);if("whitespace"===b.type){var g=e(a.substring(c));return g.length+=c,g}if("quote"===b.type){var h=e(a.substring(c));return c+=h.length,delete h.length,b.cont=h.result,{length:c,result:b}}return{length:c,result:b}}function f(a){for(var b,c,d=a.startsWith("["),f=a.substring(1),g=1,h=[];result=e(f);){if(b=result.result,c=result.length,b.cont){if("list-end"===b.type){g+=c;break}h.push(b)}f=f.substring(c),g+=c}return d?{result:{type:"quote",cont:{type:"list",cont:h}},length:g}:{result:{type:"list",cont:h},length:g}}var g={"list-start":{re:/^\(|^\[/,ignore:!1},"list-end":{re:/^\)|^\]/,ignore:!1},number:{re:/^\d*\.\d+|^\d+/,ignore:!1},iden:{re:/^[\w\-+*!@#$%\^&\d\.=<>:]+/,ignore:!1},string:{re:/^"(.*?)"/,ignore:!1},whitespace:{re:/^\s+|^;.*?\n/,ignore:!0},quote:{re:/^'/,ignore:!1}};b.exports.parse=function(a){for(var b=a,c=[];result=e(b);)c.push(result.result),b=b.substring(result.length);return c}},{}],5:[function(require,module,exports){var lispjs=require("./lispjs");String.prototype.toJS=function(){lispjs.toJS(this)},String.prototype.evalLisp=function(){eval(this.toJS())}},{"./lispjs":3}]},{},[5]);